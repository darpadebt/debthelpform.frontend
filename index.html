<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Charset & Viewport -->
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- =========================
       TITLE & DESCRIPTION (CTR)
       ========================= -->
  <title>Debt Help Form — Free U.S. Debt Relief Savings Estimate (Fast, Secure & FTC-Aligned)</title>
  <meta name="description" content="Get a secure, FTC-aligned U.S. debt relief savings estimate in ~60 seconds. Compare trusted options—debt settlement & consolidation—then choose your best path." />
  <meta name="keywords" content="U.S. debt relief, debt help, debt settlement, debt consolidation, credit card debt relief, free debt estimate, FTC compliant, TCPA, Gateway Financial Settlement Relief" />

  <!-- Indexing & Canonical -->
  <meta name="robots" content="index,follow,max-image-preview:large" />
  <meta name="googlebot" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <link rel="canonical" href="https://debthelpform.com/" />

  <!-- Locale / Hreflang -->
  <meta name="geo.region" content="US" />
  <meta name="geo.placename" content="United States" />
  <link rel="alternate" href="https://debthelpform.com/" hreflang="en-us" />
  <link rel="alternate" href="https://debthelpform.com/" hreflang="x-default" />

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://debthelpform.com/" />
  <meta property="og:title" content="Debt Help Form — Free U.S. Debt Relief Savings Estimate (Fast, Secure & FTC-Aligned)" />
  <meta property="og:description" content="Get a secure, FTC-aligned U.S. debt relief savings estimate in ~60 seconds. Compare trusted options and start reducing debt." />
  <meta property="og:site_name" content="DebtHelpForm.com" />
  <meta property="og:image" content="https://debthelpform.com/og-cover.jpg" />
  <meta property="og:image:alt" content="Secure U.S. debt relief savings estimate in 60 seconds" />
  <meta property="og:locale" content="en_US" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Debt Help Form — Free U.S. Debt Relief Savings Estimate (Fast, Secure & FTC-Aligned)" />
  <meta name="twitter:description" content="Fast, secure, and compliant. Get your debt relief savings estimate in ~60 seconds." />
  <meta name="twitter:image" content="https://debthelpform.com/og-cover.jpg" />

  <!-- Helpful/UX -->
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <meta name="theme-color" content="#003366" />

  <!-- Cache hints (headers should still lead) -->
  <meta http-equiv="Cache-Control" content="public, max-age=0, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- Perf hints -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="dns-prefetch" href="//api.leadconnectorhq.com">
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://api.leadconnectorhq.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <!-- ===== A/B hook for AI Loop Optimizer (050) ===== -->
  <meta name="x-ai-optimizer-page" content="dhf:index" />
  <script>
    window.__ab = {
      pageKey: 'dhf:index',
      slots: {
        headline:   '#ab-cta-text',
        primaryCta: '.hero-ctas .btn.btn-primary',
        phoneCta:   '.hero-ctas .btn.btn-outline'
      },
      defaults: {
        primaryCtaText: '🔒 Start Secure Estimate',
        primaryCtaHref: 'https://debthelpform.com/#lead-form'
      }
    };
  </script>

  <!-- Styles -->
  <style>
    :root{
      --ink:#222; --bg:#f9fafe;
      --brand:#003366; --brand-2:#004488;
      --cta:#2563eb; --ok:#007b55;
      --shadow:0 10px 30px rgba(0,0,0,.12);
      --callbar-h:64px; --sitemap-h:52px;
    }
    *{box-sizing:border-box} html,body{margin:0;padding:0}
    body{font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.55;padding-top:76px;padding-bottom:calc(var(--sitemap-h) + 14px)}
    .skip-link{position:absolute;left:-999px;top:auto;width:1px;height:1px;overflow:hidden}
    .skip-link:focus{position:fixed;left:12px;top:12px;padding:.5rem .75rem;background:#000;color:#fff;z-index:10000;border-radius:6px}

    /* Sticky Nav */
    .sticky-nav{position:fixed;top:0;left:0;right:0;background:var(--brand-2);z-index:9999;box-shadow:0 2px 5px rgba(0,0,0,.08)}
    .sticky-nav ul{display:flex;gap:.75rem;margin:0;padding:.75rem 1rem;overflow-x:auto;white-space:nowrap;list-style:none}
    .sticky-nav a{color:#fff;font-weight:600;text-decoration:none;padding:.4rem .6rem;border-radius:6px}
    .sticky-nav a:hover,.sticky-nav a:focus{text-decoration:underline;outline:none}

    /* Hero (blue card) */
    header.hero{max-width:960px;margin:0 auto 1rem;text-align:center;background:var(--brand);color:#fff;padding:1.8rem 1rem;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.08)}
    header.hero h1{margin:0 0 .5rem;font-size:clamp(1.7rem,3vw + 1rem,2.4rem);font-weight:800}
    header.hero p.sub{margin:.25rem 0 .5rem;color:#f1f5f9}
    .hero-ctas{display:flex;justify-content:center;gap:.6rem;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.4rem;border-radius:10px;padding:.7rem 1.05rem;font-weight:800;text-decoration:none}
    .btn.btn-primary{background:var(--cta);color:#fff;box-shadow:var(--shadow)}
    .btn.btn-outline{background:transparent;color:#fff;border:2px solid rgba(255,255,255,.75)}

    /* Section card */
    section{max-width:960px;margin:1.25rem auto;background:#fff;border-radius:12px;padding:1.25rem;box-shadow:0 2px 12px rgba(0,0,0,.07);border:1px solid #e5e7eb}
    section h2{margin-top:0;font-size:clamp(1.25rem,2vw + .8rem,1.8rem)}
    .lead{margin:.25rem 0 1rem;color:#444}

    /* Trust links */
    .trust-links{margin-top:1.25rem;font-size:.96rem}
    .trust-links ul{padding-left:1.1rem}
    .trust-links a{color:#0055aa;text-decoration:none}
    .trust-links a:hover{text-decoration:underline}

    /* Mobile dual-action bar */
    .mobile-bar{position:fixed;left:0;right:0;bottom:0;background:#0b1220;color:#fff;display:flex;gap:8px;padding:.6rem;z-index:10000}
    .mobile-bar a{flex:1;text-align:center;border-radius:10px;padding:.75rem .5rem;font-weight:900;text-decoration:none}
    .mobile-call{background:var(--ok);color:#fff}
    .mobile-est{background:var(--cta);color:#fff}
    @media(min-width:769px){.mobile-bar{display:none}}

    /* Floating bottom sitemap */
    .sticky-menu{position:fixed;left:0;right:0;bottom:calc(var(--callbar-h) + env(safe-area-inset-bottom));background:#004488;color:#fff;border-top:2px solid #2563eb;height:var(--sitemap-h);display:flex;align-items:center;z-index:9997}
    .sticky-menu nav{display:flex;gap:1rem;overflow-x:auto;white-space:nowrap;padding:0 .75rem;width:100%;align-items:center}
    .sticky-menu nav a{color:#ffdd00;text-decoration:none;padding:.35rem .55rem;border-radius:6px;font-weight:700;font-size:.92rem;flex:0 0 auto}
    .sticky-menu nav a:hover{background:rgba(255,255,255,.1)}

    footer{max-width:960px;margin:1.25rem auto 5.5rem;text-align:center;color:#666}
    footer a{color:#0055aa;text-decoration:none}
    footer a:hover{text-decoration:underline}
  </style>

  <!-- =========================
       STRUCTURED DATA (JSON-LD)
       ========================= -->

  <!-- WebSite + SearchAction -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"DebtHelpForm.com",
    "url":"https://debthelpform.com/",
    "inLanguage":"en-US",
    "potentialAction":{
      "@type":"SearchAction",
      "target":"https://debthelpform.com/?q={search_term_string}",
      "query-input":"required name=search_term_string"
    },
    "publisher": { "@id": "https://gatewaydebthelp.com/#gfsr" }
  }
  </script>

  <!-- Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://debthelpform.com/"},
      {"@type":"ListItem","position":2,"name":"Debt Relief Options","item":"https://debthelpform.com/relief.html"},
      {"@type":"ListItem","position":3,"name":"State Programs","item":"https://debthelpform.com/geo-debt-relief.html"},
      {"@type":"ListItem","position":4,"name":"Blog","item":"https://debthelpform.com/debthelpform-pages-blog.html"},
      {"@type":"ListItem","position":5,"name":"Contact","item":"https://debthelpform.com/contact.html"}
    ]
  }
  </script>

  <!-- Financial Service (homepage as service landing) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FinancialService",
    "name":"Debt Relief Savings Estimate",
    "serviceType":"Debt relief consultation and savings estimate",
    "provider":{"@id":"https://gatewaydebthelp.com/#gfsr"},
    "url":"https://debthelpform.com/",
    "areaServed":"United States",
    "isAccessibleForFree":true
  }
  </script>

  <!-- Organization (GFSR) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":["Organization","FinancialService"],
    "@id":"https://gatewaydebthelp.com/#gfsr",
    "name":"Gateway Financial Settlement Relief, LLC",
    "legalName":"Gateway Financial Settlement Relief, LLC",
    "alternateName":["Gateway Debt Help","GFSR"],
    "url":"https://gatewaydebthelp.com/",
    "logo":"https://debthelpform.com/og-cover.jpg",
    "telephone":"+1-888-437-7141",
    "address":{"@type":"PostalAddress","addressCountry":"US","addressRegion":"FL"},
    "areaServed":{"@type":"Country","name":"United States"},
    "sameAs":[
      "https://gatewayfinancialsettlementrelief.com/",
      "https://debthelpform.com/",
      "https://debtreliefguard.com/",
      "https://gatewaydebthelp.com/"
    ],
    "contactPoint":{
      "@type":"ContactPoint","telephone":"+1-888-437-7141","contactType":"customer service","areaServed":"US","availableLanguage":["English"]
    },
    "disambiguatingDescription":"Florida-operated, Wyoming-registered debt relief company using 'Gateway Debt Help' as a marketing tagline. Not affiliated with Gateway Debt Relief of Costa Mesa, CA."
  }
  </script>
</head>

<body>
  <a href="#main" class="skip-link">Skip to content</a>

  <!-- Sticky Nav -->
  <nav class="sticky-nav" role="navigation" aria-label="Main navigation">
    <ul>
      <li><a href="/" title="Home">Home</a></li>
      <li><a href="/relief.html" title="Explore Debt Relief Options">Debt Relief Options</a></li>
      <li><a href="/geo-debt-relief.html" title="State Programs">State Programs</a></li>
      <li><a href="/debthelpform-pages-blog.html" title="Debt Help Blog">Debt Help Blog</a></li>
      <li><a href="/contact.html" title="Contact">Contact</a></li>
      <li><a href="/privacy.html" title="Privacy Policy">Privacy</a></li>
      <li><a href="https://gatewaydebthelp.com" target="_blank" rel="noopener">GatewayDebtHelp.com</a></li>
      <li><a href="https://debtreliefguard.com" target="_blank" rel="noopener">DebtReliefGuard.com</a></li>
      <li><a href="https://gatewayfinancialsettlementrelief.com" target="_blank" rel="noopener"><strong>Site Owner</strong></a></li>
    </ul>
  </nav>

  <!-- Desktop call pill -->
  <a class="desk-call" href="tel:+18884377141">📞 888-437-7141</a>

  <!-- HERO -->
  <header class="hero">
    <h1 id="ab-cta-text">Free Debt Relief Savings Estimate — Fast, Secure & FTC-Aligned</h1>
    <p class="sub">Answer a few questions to see how much you could save. No pressure, no hard credit check.</p>
    <div class="hero-ctas">
      <a class="btn btn-primary" href="#lead-form">🔒 Start Secure Estimate</a>
      <a class="btn btn-outline" href="tel:+18884377141">📞 Call 888-437-7141</a>
    </div>
  </header>

  <!-- Main -->
  <main id="main">
    <section>
      <h2>See How Much You Could Save</h2>
      <p class="lead">We compare trusted debt relief options—settlement, consolidation, counseling—so you can pick what fits best.</p>

      <!-- Lead Form (GoHighLevel) -->
      <div id="lead-form" aria-label="Debt Relief Estimate Form">
        <iframe
          src="https://api.leadconnectorhq.com/widget/form/A5c9I3HkyNd1puU4nJWl"
          style="width:100%; height:1360px; border:none; border-radius:10px;"
          title="Debt Relief Estimate Form"
          loading="lazy"
          referrerpolicy="strict-origin-when-cross-origin"
          onload="trackConversion && trackConversion()"></iframe>
        <script src="https://link.msgsndr.com/js/form_embed.js" defer></script>
      </div>

      <!-- Trust signals -->
      <div class="trust-links">
        <h3>Consumer-First Guidance</h3>
        <ul>
          <li><a href="https://consumer.ftc.gov" target="_blank" rel="noopener">FTC — Consumer Protection</a></li>
          <li><a href="https://consumerfinance.gov" target="_blank" rel="noopener">CFPB — Debt Relief Guidance</a></li>
          <li><a href="https://identitytheft.gov" target="_blank" rel="noopener">IdentityTheft.gov — Recover</a></li>
          <li><a href="https://usa.gov" target="_blank" rel="noopener">USA.gov — Assistance Programs</a></li>
          <li><a href="https://nfcc.org" target="_blank" rel="noopener">NFCC — Credit Counseling</a></li>
          <li><a href="/debthelpform-pages-blog.html">Debt Relief Guides & Blog</a></li>
        </ul>
      </div>
    </section>
  </main>

  <!-- Mobile dual action bar -->
  <div id="dhfMobileBar" class="mobile-bar" aria-label="Quick actions">
    <a class="mobile-call" href="tel:+18884377141">📞 Call 888-437-7141</a>
    <a class="mobile-est" href="#lead-form">🔒 Start Estimate</a>
  </div>

  <!-- Floating bottom sitemap -->
  <footer class="sticky-menu" role="navigation" aria-label="Site map">
    <nav>
      <a href="/">Home</a>
      <a href="/relief.html">Debt Relief Options</a>
      <a href="/geo-debt-relief.html">State Programs</a>
      <a href="/debthelpform-pages-blog.html">Debt Help Blog</a>
      <a href="/contact.html">Contact</a>
      <a href="/privacy.html">Privacy</a>
      <a href="https://gatewaydebthelp.com" target="_blank" rel="noopener">GatewayDebtHelp.com</a>
      <a href="https://debtreliefguard.com" target="_blank" rel="noopener">DebtReliefGuard.com</a>
    </nav>
  </footer>

  <!-- Footer -->
  <footer style="max-width:960px;margin:1.25rem auto 5.5rem;text-align:center;color:#666">
    <p>&copy; 2025 DebtHelpForm.com. All rights reserved.</p>
    <p>Website owned and operated by <a href="https://gatewayfinancialsettlementrelief.com" target="_blank" rel="noopener">Gateway Financial Settlement Relief</a></p>
    <p style="font-size:.82rem;color:#999">“Gateway Debt Help” is the marketing brand of <strong>Gateway Financial Settlement Relief, LLC</strong>. Not affiliated with “Gateway Debt Relief” of Costa Mesa, CA.</p>
  </footer>

  <!-- Honeypot -->
  <script>
    (function(){
      const honeypot=document.createElement("input");
      honeypot.type="text"; honeypot.name="website"; honeypot.autocomplete="off";
      honeypot.hidden=true; honeypot.setAttribute("aria-hidden","true");
      document.body.appendChild(honeypot);
      let moved=false,t=0; addEventListener('mousemove',()=>moved=true,{passive:true});
      addEventListener('keydown',()=>moved=true,{passive:true});
      setInterval(()=>t++,1000);
      window.validateBotProtections=()=> (honeypot.value==="" && moved && t>=3);
    })();
  </script>

  <!-- Dynamic spacing for mobile bar -->
  <script>
    (function(){
      const root=document.documentElement, mb=document.getElementById('dhfMobileBar');
      function setH(){ const h=mb && getComputedStyle(mb).display!=='none' ? mb.offsetHeight : 0; root.style.setProperty('--callbar-h', h+'px'); }
      setH(); addEventListener('resize', setH, {passive:true}); setTimeout(setH,250); setTimeout(setH,1000);
    })();
  </script>

  <!-- Worker Integrations: 050 (headline), 015 (telemetry) -->
  <script>
  (() => {
    const now = () => Date.now();
    const sleep = (ms) => new Promise(r => setTimeout(r, ms));
    const timeoutFetch = (url, opts={}, ms=5000) => {
      const ctrl = new AbortController(); const to=setTimeout(()=>ctrl.abort(), ms);
      return fetch(url, { ...opts, signal: ctrl.signal }).finally(()=>clearTimeout(to));
    };
    const safeText = (s) => (s ?? '').toString();

    /* 050: Savings message (GET /api/savings-message) */
    (async function loadSavingsMessage(){
      const el = document.querySelector('#ab-cta-text'); if(!el) return;
      const FALLBACK = el.textContent || "Free Debt Relief Savings Estimate — Fast, Secure & FTC-Aligned";
      const CACHE_KEY = 'dhf:savings:v1'; const MAX_AGE_MS = 10*60*1000;

      try{
        const raw = localStorage.getItem(CACHE_KEY);
        if (raw){
          const { ts, message } = JSON.parse(raw);
          if (ts && (now()-ts) < MAX_AGE_MS && message) el.textContent = safeText(message);
        }
      }catch(_){}

      let ok=false, data;
      for (let attempt=0; attempt<2 && !ok; attempt++){
        try{
          let r = await timeoutFetch('/api/savings-message', { headers:{'Accept':'application/json','X-Requested-With':'XMLHttpRequest'}, cache:'no-store', credentials:'omit' }, attempt ? 4500 : 3500);
          if(!r.ok || !r.headers.get('content-type')?.includes('application/json')) throw new Error('HTTP '+r.status);
          data = await r.json();
          if (data && data.message){
            el.textContent = safeText(data.message);
            ok = true;
            try{ localStorage.setItem(CACHE_KEY, JSON.stringify({ ts: now(), message: data.message })); }catch(_){}
          }
        }catch(e){ await sleep(200); }
      }
      if(!ok) el.textContent = FALLBACK;
    })();

    /* 015: Telemetry ping (POST /ingest) */
    (function sendTelemetry(){
      try{
        const key='dhf:sess:v1'; let sid=sessionStorage.getItem(key);
        if(!sid){ sid=crypto.randomUUID(); sessionStorage.setItem(key, sid); }
        const payload={ v:1, ts:now(), sid, url:location.href, ref:document.referrer||null, w:innerWidth, h:innerHeight };
        const blob=new Blob([JSON.stringify(payload)],{type:'application/json'});
        if(navigator.sendBeacon) navigator.sendBeacon('/ingest', blob);
        else fetch('/ingest',{ method:'POST', body:blob, keepalive:true, headers:{'Content-Type':'application/json'} }).catch(()=>{});
      }catch(_){}
    })();
  })();
  </script>

  <!-- Service Worker (cache HTML SWR + asset cache-first) -->
  <script>
    (function(){
      if (!('serviceWorker' in navigator)) return;
      const swCode = `
        const VERSION = 'dhf-sw-v1.0.0';
        const HTML_CACHE = 'dhf-html-' + VERSION;
        const ASSET_CACHE = 'dhf-asset-' + VERSION;
        const API_CACHE = 'dhf-api-' + VERSION;
        const PRECACHE_URLS = ['/', '/relief.html', '/geo-debt-relief.html', '/debthelpform-pages-blog.html', '/contact.html', '/privacy.html'];
        const isHTML = req => req.mode === 'navigate' || (req.headers.get('accept')||'').includes('text/html');
        const isAsset = url => /\\.(?:css|js|mjs|cjs|png|jpe?g|gif|svg|webp|ico|woff2?|ttf|otf)$/i.test(url.pathname);
        const isThirdParty = url => location.origin !== url.origin;
        const passthru = url => /(^|\\.)leadconnectorhq\\.com$/.test(url.hostname) || /(^|\\.)msgsndr\\.com$/.test(url.hostname);
        self.addEventListener('install', e=>e.waitUntil(caches.open(HTML_CACHE).then(c=>c.addAll(PRECACHE_URLS)).then(()=>self.skipWaiting())));
        self.addEventListener('activate', e=>e.waitUntil(caches.keys().then(keys=>Promise.all(keys.map(k=>!k.includes(VERSION)&&caches.delete(k)))).then(()=>self.clients.claim())));
        async function handleHTML(req){ const c=await caches.open(HTML_CACHE); const hit=await c.match(req,{ignoreSearch:true}); const net=fetch(req).then(r=>{if(r.status===200)c.put(req,r.clone());return r;}).catch(()=>hit||Response.error()); return hit||net; }
        async function handleAsset(req){ const c=await caches.open(ASSET_CACHE); const hit=await c.match(req); if(hit) return hit; const r=await fetch(req).catch(()=>null); if(r&&r.status===200){ await c.put(req,r.clone()); } return r||Response.error(); }
        async function handleAPI(req){ const c=await caches.open(API_CACHE); const hit=await c.match(req); const net=fetch(req).then(r=>{ if(r.status===200) c.put(req,r.clone()); return r;}).catch(()=>hit||Response.error()); return hit||net; }
        self.addEventListener('fetch', e=>{
          const url=new URL(e.request.url); const req=e.request;
          if(isThirdParty(url) && passthru(url)) return;
          if(req.method!=='GET') return;
          if(isHTML(req)) { e.respondWith(handleHTML(req)); return; }
          if(url.pathname.startsWith('/api/savings-message')) { e.respondWith(handleAPI(req)); return; }
          if(isAsset(url)) { e.respondWith(handleAsset(req)); return; }
          e.respondWith(fetch(req).catch(async()=>{ const c=await caches.open(ASSET_CACHE); return (await c.match(req)) || Response.error(); }));
        });
      `;
      try{
        const blobURL = URL.createObjectURL(new Blob([swCode], { type:'text/javascript' }));
        navigator.serviceWorker.register(blobURL, { scope:'/' }).catch(()=>{});
      }catch(_){}
    })();
  </script>

  <!-- Chat (016) -->
  <button id="gfsrChatFab" class="gfsr-chat-fab" aria-haspopup="dialog" aria-expanded="false" aria-controls="gfsrChatSheet"
          style="position:fixed; right:14px; bottom:calc(var(--callbar-h) + var(--sitemap-h) + 14px); z-index:10003;">💬 Chat</button>

  <section id="gfsrChatSheet" class="gfsr-chat-sheet" role="dialog" aria-modal="true"
           aria-labelledby="gfsrChatTitle" aria-describedby="gfsrChatDesc" hidden>
    <header class="gfsr-chat-head">
      <div>
        <div id="gfsrChatTitle" class="gfsr-chat-title">Debt Help Assistant</div>
        <div id="gfsrChatDesc" class="sr-only">Chat with our assistant. Press Escape to close.</div>
      </div>
      <button id="gfsrChatClose" class="gfsr-chat-close" aria-label="Close chat">✕</button>
    </header>
    <div id="gfsrChatBody" class="gfsr-chat-body" tabindex="0"></div>
    <form id="gfsrChatForm" class="gfsr-chat-input">
      <label class="sr-only" for="gfsrChatInput">Type your message</label>
      <textarea id="gfsrChatInput" rows="1" placeholder="Type a message…" aria-label="Message"></textarea>
      <button id="gfsrChatSend" class="gfsr-chat-send" type="submit">Send</button>
    </form>
  </section>

  <script>
  (() => {
    const el = { fab:document.getElementById('gfsrChatFab'), sheet:document.getElementById('gfsrChatSheet'),
                 close:document.getElementById('gfsrChatClose'), body:document.getElementById('gfsrChatBody'),
                 form:document.getElementById('gfsrChatForm'), input:document.getElementById('gfsrChatInput'),
                 send:document.getElementById('gfsrChatSend') };

    const openChat=()=>{ el.sheet.removeAttribute('hidden'); el.sheet.classList.add('open'); el.fab.setAttribute('aria-expanded','true'); setTimeout(()=>el.input.focus(),120); };
    const closeChat=()=>{ el.sheet.classList.remove('open'); el.fab.setAttribute('aria-expanded','false'); el.sheet.setAttribute('hidden',''); el.fab.focus(); };
    el.fab.addEventListener('click', openChat); el.close.addEventListener('click', closeChat);
    addEventListener('keydown', e => { if (e.key==='Escape' && !el.sheet.hasAttribute('hidden')) closeChat(); });

    const addMsg=(t,w='bot')=>{ const d=document.createElement('div'); d.className=`gfsr-msg ${w}`; d.textContent=(t??'').toString(); el.body.appendChild(d); el.body.scrollTop=el.body.scrollHeight; };
    const KEY='dhf:chat-history';
    try{ (JSON.parse(localStorage.getItem(KEY)||'[]')).slice(-20).forEach(m=>addMsg(m.text,m.who)); }catch{}
    const remember=(t,w)=>{ try{ const h=JSON.parse(localStorage.getItem(KEY)||'[]'); h.push({text:t,who:w,t:Date.now()}); localStorage.setItem(KEY, JSON.stringify(h).slice(-8000)); }catch{} };

    const API=`${location.origin}/chat`; let busy=false;
    el.form.addEventListener('submit', async (e)=>{
      e.preventDefault(); if(busy) return;
      const msg=(el.input.value||'').trim(); if(!msg) return;
      addMsg(msg,'user'); remember(msg,'user'); el.input.value=''; busy=true; el.send.disabled=true;
      try{
        const r=await fetch(API,{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({messages:[{role:'user',content:msg}],source:'frontend',url:location.href})});
        if(!r.ok) throw new Error('HTTP '+r.status);
        const ct=r.headers.get('content-type')||''; let reply=''; reply = ct.includes('application/json') ? (await r.json()).reply || '' : await r.text();
        addMsg(reply||'Thanks — how else can I help?','bot'); remember(reply||'','bot');
      }catch(err){ console.error(err); addMsg('Service busy — please try again shortly.','meta'); }
      finally{ busy=false; el.send.disabled=false; el.input.focus(); }
    });

    el.input.addEventListener('keydown', e => { if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); el.form.requestSubmit(); } });
    if(!el.body.children.length) addMsg('Hi! I can help you compare debt relief options and next steps.');
  })();
  </script>

  <!-- <noscript> -->
  <noscript><p style="text-align:center;color:#666">Enable JavaScript to load your personalized savings estimate and chat.</p></noscript>
</body>
</html>
