<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Charset & Viewport -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- =========================
       TITLE & DESCRIPTION (CTR)
       ========================= -->
  <title>Debt Help Form — Free U.S. Debt Relief Savings Estimate (Fast, Secure & FTC-Aligned)</title>
  <meta name="description" content="Get a secure, FTC-aligned U.S. debt relief savings estimate in 60 seconds. Compare trusted options—debt settlement & consolidation—then choose your best path today." />

  <!-- =========================
       KEYWORDS (lightweight cue)
       ========================= -->
  <meta name="keywords" content="U.S. debt relief, debt help, debt settlement, debt consolidation, credit card debt relief, free debt estimate, FTC compliant, TCPA, Gateway Financial Settlement Relief" />

  <!-- =========================
       INDEXING & CANONICAL
       ========================= -->
  <meta name="robots" content="index,follow,max-image-preview:large" />
  <meta name="googlebot" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <link rel="canonical" href="https://debthelpform.com/" />

  <!-- =========================
       GEO / LOCALE / HREFLANG
       ========================= -->
  <meta name="geo.region" content="US" />
  <meta name="geo.placename" content="United States" />
  <link rel="alternate" href="https://debthelpform.com/" hreflang="en-us" />
  <link rel="alternate" href="https://debthelpform.com/" hreflang="x-default" />

  <!-- =========================
       OPEN GRAPH / TWITTER
       ========================= -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://debthelpform.com/" />
  <meta property="og:title" content="Debt Help Form — Free U.S. Debt Relief Savings Estimate (Fast, Secure & FTC-Aligned)" />
  <meta property="og:description" content="Get a secure, FTC-aligned U.S. debt relief savings estimate in 60 seconds. Compare trusted options and start reducing debt today." />
  <meta property="og:site_name" content="DebtHelpForm.com" />
  <meta property="og:image" content="https://debthelpform.com/og-cover.jpg" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:image:alt" content="Secure U.S. debt relief savings estimate in 60 seconds" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Debt Help Form — Free U.S. Debt Relief Savings Estimate (Fast, Secure & FTC-Aligned)" />
  <meta name="twitter:description" content="Fast, secure, and compliant. Get your debt relief savings estimate in 60 seconds." />
  <meta name="twitter:image" content="https://debthelpform.com/og-cover.jpg" />

  <!-- Helpful/UX -->
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <meta name="theme-color" content="#003366" />

  <!-- =========================
       CACHE HINTS (META)
       ========================= -->
  <!-- CACHE UPGRADE: meta hints (server headers still take precedence) -->
  <meta http-equiv="Cache-Control" content="public, max-age=0, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <!-- Perf hints -->
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="dns-prefetch" href="//api.leadconnectorhq.com">
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://api.leadconnectorhq.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

  <!-- Styles (mobile-first, lightweight) -->
  <style>
    :root {
      --brand:#003366; --brand-2:#004488; --cta:#2563eb; --ok:#007b55;
      --ink:#222; --bg:#f9fafe;
    }
    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; }
    body {
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg); color: var(--ink); line-height:1.55; padding-top:76px;
    }
    .skip-link { position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden; }
    .skip-link:focus { position:fixed; left:12px; top:12px; padding:.5rem .75rem; background:#000; color:#fff; z-index:10000; border-radius:6px; }

    /* Sticky Nav */
    .sticky-nav { position:fixed; top:0; left:0; right:0; background:var(--brand-2); z-index:9999; box-shadow:0 2px 5px rgba(0,0,0,.08); }
    .sticky-nav ul { display:flex; gap:.75rem; margin:0; padding:.75rem 1rem; overflow-x:auto; white-space:nowrap; list-style:none; }
    .sticky-nav a { color:#fff; font-weight:600; text-decoration:none; padding:.4rem .6rem; border-radius:6px; }
    .sticky-nav a:hover, .sticky-nav a:focus { text-decoration:underline; outline:none; }

    /* Hero */
    header { max-width:960px; margin:0 auto; text-align:center; background:var(--brand); color:#fff; padding:2rem 1rem 1.5rem; border-radius:10px; }
    header h1 { margin:0 0 .5rem; font-size:clamp(1.6rem, 3vw + 1rem, 2.4rem); }
    header p { margin:.25rem 0 .5rem; }
    header a { color:#ffdd00; font-weight:700; text-decoration:none; }
    header a:hover { text-decoration:underline; }

    /* Section */
    section { max-width:960px; margin:1.5rem auto; background:#fff; border-radius:10px; padding:1.25rem; box-shadow:0 2px 12px rgba(0,0,0,.07); }
    section h2 { margin-top:0; font-size:clamp(1.25rem, 2vw + .8rem, 1.75rem); }
    .lead { margin:.25rem 0 1rem; color:#444; }

    /* Trust links */
    .trust-links { margin-top:1.25rem; font-size:.96rem; }
    .trust-links ul { padding-left:1.1rem; }
    .trust-links a { color:#0055aa; text-decoration:none; }
    .trust-links a:hover { text-decoration:underline; }

    /* Mobile call bar */
    .mobile-call { display:none; position:fixed; bottom:0; left:0; right:0; background:var(--ok); color:#fff; text-align:center; padding:.9rem; z-index:9998; }
    .mobile-call a { color:#fff; font-weight:800; text-decoration:none; }
    @media (max-width:768px){ .mobile-call{ display:block; } }

    footer { max-width:960px; margin:1.25rem auto 3.5rem; text-align:center; color:#666; }
    footer a { color:#0055aa; text-decoration:none; }
    footer a:hover { text-decoration:underline; }
  </style>

  <!-- =========================
       STRUCTURED DATA (JSON-LD)
       ========================= -->

  <!-- WebSite + SearchAction -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"DebtHelpForm.com",
    "url":"https://debthelpform.com/",
    "inLanguage":"en-US",
    "potentialAction":{
      "@type":"SearchAction",
      "target":"https://debthelpform.com/?q={search_term_string}",
      "query-input":"required name=search_term_string"
    },
    "publisher":{
      "@type":"Organization",
      "name":"Gateway Financial Settlement Relief",
      "url":"https://gatewayfinancialsettlementrelief.com"
    }
  }
  </script>

  <!-- Breadcrumbs -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://debthelpform.com/"},
      {"@type":"ListItem","position":2,"name":"Debt Relief Options","item":"https://debthelpform.com/relief.html"},
      {"@type":"ListItem","position":3,"name":"State Programs","item":"https://debthelpform.com/geo-debt-relief.html"},
      {"@type":"ListItem","position":4,"name":"Debt Help Blog","item":"https://debthelpform.com/debthelpform-pages-blog.html"},
      {"@type":"ListItem","position":5,"name":"Contact","item":"https://debthelpform.com/contact.html"}
    ]
  }
  </script>

  <!-- Organization (GFSR) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Organization",
    "@id":"https://gatewayfinancialsettlementrelief.com#org",
    "name":"Gateway Financial Settlement Relief",
    "alternateName":["GFSR","Gateway Debt Help","Debt Relief Guard"],
    "url":"https://gatewayfinancialsettlementrelief.com",
    "logo":"https://debthelpform.com/og-cover.jpg",
    "telephone":"+1-888-437-7141",
    "sameAs":[
      "https://debthelpform.com/",
      "https://debtreliefguard.com/",
      "https://gatewaydebthelp.com/"
    ],
    "areaServed":{"@type":"Country","name":"United States"},
    "contactPoint":{
      "@type":"ContactPoint",
      "telephone":"+1-888-437-7141",
      "contactType":"customer service",
      "areaServed":"US",
      "availableLanguage":["English"]
    }
  }
  </script>

  <!-- Financial Service -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FinancialService",
    "name":"Debt Relief Savings Estimate",
    "serviceType":"Debt relief consultation and savings estimate",
    "provider":{"@id":"https://gatewayfinancialsettlementrelief.com#org"},
    "url":"https://debthelpform.com/",
    "areaServed":"US",
    "isAccessibleForFree":true,
    "termsOfService":"https://debthelpform.com/privacy.html"
  }
  </script>

  <!-- FAQ -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"How quickly can I get a debt relief savings estimate?","acceptedAnswer":{"@type":"Answer","text":"Most people receive a baseline estimate in under 60 seconds via our secure form. No pressure—just answers."}},
      {"@type":"Question","name":"Will this affect my credit score?","acceptedAnswer":{"@type":"Answer","text":"Requesting an estimate here does not affect your credit score. We do not run a hard inquiry."}},
      {"@type":"Question","name":"Is this aligned with FTC and TCPA compliance?","acceptedAnswer":{"@type":"Answer","text":"Yes. We follow FTC advertising guidelines and TCPA best practices. No misleading claims or fake testimonials."}},
      {"@type":"Question","name":"What types of debt are typically eligible?","acceptedAnswer":{"@type":"Answer","text":"Common eligible debts include credit cards, personal loans, medical bills, and other unsecured debts. Mortgages and auto loans are generally excluded."}},
      {"@type":"Question","name":"Is this service available across the United States?","acceptedAnswer":{"@type":"Answer","text":"Yes, we serve residents across the U.S., with guidance that reflects state-specific considerations where applicable."}}
    ]
  }
  </script>
</head>

<body>
  <a href="#main" class="skip-link">Skip to content</a>

  <!-- Sticky Nav -->
  <nav class="sticky-nav" role="navigation" aria-label="Main navigation">
    <ul>
      <li><a href="/" title="Debt Help Form Home">Home</a></li>
      <li><a href="/relief.html" title="Explore Debt Relief Options">Debt Relief Options</a></li>
      <li><a href="/geo-debt-relief.html" title="State-Based Debt Relief Programs">State Programs</a></li>
      <li><a href="/debthelpform-pages-blog.html" title="Debt Help Blog & Guides">Debt Help Blog</a></li>
      <li><a href="/contact.html" title="Contact Debt Help Form">Contact Us</a></li>
      <li><a href="/privacy.html" title="Privacy and Compliance Policy">Privacy Policy</a></li>
      <li><a href="https://gatewaydebthelp.com" target="_blank" rel="noopener noreferrer" title="Gateway Debt Help">GatewayDebtHelp.com</a></li>
      <li><a href="https://debtreliefguard.com" target="_blank" rel="noopener noreferrer" title="Debt Relief Guard Reviews">DebtReliefGuard.com</a></li>
      <li><a href="https://gatewayfinancialsettlementrelief.com" target="_blank" rel="noopener noreferrer" title="Gateway Financial Settlement Relief Official"><strong>Site Owner</strong></a></li>
    </ul>
  </nav>

  <!-- Mobile Call -->
  <div class="mobile-call" aria-label="Tap to call 888-437-7141">
    <a href="tel:+18884377141">📞 Tap to Call: 888-437-7141</a>
  </div>

  <!-- Header / Hero -->
  <header>
    <h1 id="ab-cta-text">Free Debt Relief Savings Estimate — Fast, Secure & FTC-Aligned</h1>
    <p><a href="tel:+18884377141">📞 Call Now: 888-437-7141</a></p>
  </header>

  <!-- Main -->
  <main id="main">
    <section>
      <h2>See How Much You Could Save on Credit Card & Unsecured Debt</h2>
      <p class="lead">Answer a few quick questions and get a personalized, no-pressure estimate. We compare trusted debt relief options so you can choose what fits best.</p>

      <!-- Lead Form (GoHighLevel) -->
      <div id="lead-form" aria-label="Debt Relief Estimate Form">
        <iframe
          src="https://api.leadconnectorhq.com/widget/form/A5c9I3HkyNd1puU4nJWl"
          style="width:100%; height:1360px; border:none; border-radius:6px;"
          title="Debt Relief Estimate Form"
          loading="lazy"
          referrerpolicy="strict-origin-when-cross-origin"
          onload="trackConversion()"></iframe>
        <script src="https://link.msgsndr.com/js/form_embed.js" defer></script>
      </div>

      <!-- Trust signals / internal links -->
      <div class="trust-links">
        <h3>Consumer-First Resources & Trust</h3>
        <ul>
          <li><a href="https://consumer.ftc.gov" target="_blank" rel="noopener">FTC — Advertising & Consumer Protection</a></li>
          <li><a href="https://consumerfinance.gov" target="_blank" rel="noopener">CFPB — Debt Relief Guidance</a></li>
          <li><a href="https://identitytheft.gov" target="_blank" rel="noopener">IdentityTheft.gov — ID Theft Help</a></li>
          <li><a href="https://usa.gov" target="_blank" rel="noopener">USA.gov — Assistance Programs</a></li>
          <li><a href="https://nfcc.org" target="_blank" rel="noopener">NFCC — Credit Counseling</a></li>
          <li><a href="/debthelpform-pages-blog.html">Debt Relief Guides & Blog</a></li>
        </ul>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 DebtHelpForm.com. All rights reserved.</p>
    <p>Website owned and operated by <a href="https://gatewayfinancialsettlementrelief.com" target="_blank" rel="noopener">Gateway Financial Settlement Relief</a></p>
    <p style="font-size:.82rem; color:#999;">Last updated: August 2025</p>
  </footer>

  <!-- Bot heuristic (simple honeypot) -->
  <script>
    (function(){
      const honeypot = document.createElement("input");
      honeypot.type="text"; honeypot.name="website"; honeypot.autocomplete="off";
      honeypot.hidden=true; honeypot.setAttribute("aria-hidden","true");
      document.body.appendChild(honeypot);
      let u=false,t=0; addEventListener('mousemove',()=>u=true,{passive:true});
      addEventListener('keydown',()=>u=true,{passive:true});
      setInterval(()=>t++,1000);
      window.validateBotProtections=()=> (honeypot.value==="" && u && t>=3);
    })();
  </script>

  <!-- Worker Integrations: 050 (headline), 015 (telemetry) -->
  <script>
  (() => {
    const now = () => Date.now();
    const sleep = (ms) => new Promise(r => setTimeout(r, ms));
    const timeoutFetch = (url, opts={}, ms=5000) => {
      const ctrl = new AbortController(); const to=setTimeout(()=>ctrl.abort(), ms);
      return fetch(url, { ...opts, signal: ctrl.signal }).finally(()=>clearTimeout(to));
    };
    const safeText = (s) => (s ?? '').toString();

    /* ===== 050: Savings message (GET /api/savings-message) with SWR cache + hardened retry ===== */
    (async function loadSavingsMessage(){
      const el = document.querySelector('#ab-cta-text'); if(!el) return;
      const FALLBACK = el.textContent || "Free Debt Relief Savings Estimate — Fast, Secure & FTC-Aligned";
      const CACHE_KEY = 'dhf:savings:v1'; const MAX_AGE_MS = 10 * 60 * 1000;

      try {
        const raw = localStorage.getItem(CACHE_KEY);
        if (raw) {
          const { ts, message } = JSON.parse(raw);
          if (ts && (now()-ts) < MAX_AGE_MS && message) el.textContent = safeText(message);
        }
      } catch(_) {}

      let ok=false, data;
      for(let attempt=0; attempt<2 && !ok; attempt++){
        try{
          let r = await timeoutFetch('/api/savings-message', {
            headers: { 'Accept':'application/json', 'X-Requested-With':'XMLHttpRequest' },
            cache:'no-store', credentials:'omit'
          }, attempt ? 4500 : 3500);
          if(!r.ok || !r.headers.get('content-type')?.includes('application/json')) throw new Error('HTTP '+r.status);
          data = await r.json();
          if(data && data.message){
            el.textContent = safeText(data.message);
            ok=true;
            try{ localStorage.setItem(CACHE_KEY, JSON.stringify({ ts: now(), message: data.message })); }catch(_){}
          }
        }catch(e){ await sleep(200); }
      }
      if(!ok) el.textContent = FALLBACK;
    })();

    /* ===== 015: Telemetry ping (POST /ingest) — anonymous, session key ===== */
    (function sendTelemetry(){
      try{
        const key='dhf:sess:v1'; let sid=sessionStorage.getItem(key);
        if(!sid){ sid=crypto.randomUUID(); sessionStorage.setItem(key, sid); }
        const payload={ v:1, ts:now(), sid, url:location.href, ref:document.referrer||null, w:innerWidth, h:innerHeight };
        const blob=new Blob([JSON.stringify(payload)],{type:'application/json'});
        if(navigator.sendBeacon) navigator.sendBeacon('/ingest', blob);
        else fetch('/ingest',{ method:'POST', body:blob, keepalive:true, headers:{'Content-Type':'application/json'} }).catch(()=>{});
      }catch(_){}
    })();
  })();
  </script>

  <!-- =========================
       DARPA-GRADE CACHING (SW)
       ========================= -->
  <script>
  // CACHE UPGRADE: install a high-performance Service Worker without extra files.
  (function(){
    if (!('serviceWorker' in navigator)) return;

    const swCode = `
      const VERSION = 'dhf-sw-v1.0.0';
      const HTML_CACHE = 'dhf-html-' + VERSION;
      const ASSET_CACHE = 'dhf-asset-' + VERSION;
      const API_CACHE = 'dhf-api-' + VERSION;

      const PRECACHE_URLS = [
        '/', '/relief.html', '/geo-debt-relief.html', '/debthelpform-pages-blog.html', '/contact.html', '/privacy.html'
      ];

      // Helper: classify
      const isHTML = req => req.mode === 'navigate' || (req.headers.get('accept')||'').includes('text/html');
      const isAsset = url => /\.(?:css|js|mjs|cjs|png|jpe?g|gif|svg|webp|ico|woff2?|ttf|otf)$/i.test(url.pathname);
      const isThirdParty = url => location.origin !== url.origin;
      const isBypassThirdParty = url =>
        /(^|\.)leadconnectorhq\.com$/.test(url.hostname) ||
        /(^|\.)msgsndr\.com$/.test(url.hostname);

      self.addEventListener('install', event => {
        event.waitUntil((async () => {
          const cache = await caches.open(HTML_CACHE);
          await cache.addAll(PRECACHE_URLS);
          self.skipWaiting();
        })());
      });

      self.addEventListener('activate', event => {
        event.waitUntil((async () => {
          const names = await caches.keys();
          await Promise.all(names.map(n => {
            if (!n.includes(VERSION)) return caches.delete(n);
          }));
          self.clients.claim();
        })());
      });

      // Stale-While-Revalidate for HTML (instant navs, background freshness)
      async function handleHTML(req) {
        const cache = await caches.open(HTML_CACHE);
        const cached = await cache.match(req, { ignoreSearch: true });
        const fetchPromise = fetch(req, { credentials: 'same-origin' })
          .then(resp => {
            if (resp && resp.status === 200) cache.put(req, resp.clone());
            return resp;
          })
          .catch(() => cached || Response.error());
        return cached || fetchPromise;
      }

      // Cache-first for versioned/static assets
      async function handleAsset(req, url) {
        const cache = await caches.open(ASSET_CACHE);
        const cached = await cache.match(req);
        if (cached) return cached;

        const resp = await fetch(req, { credentials: 'omit' }).catch(() => null);
        if (resp && resp.status === 200) {
          // Heuristic: long TTL for immutable assets
          const headers = new Headers(resp.headers);
          if (!headers.has('Cache-Control')) headers.set('Cache-Control', 'public, max-age=31536000, immutable');
          const body = await resp.blob();
          const newResp = new Response(body, { status: resp.status, statusText: resp.statusText, headers });
          await cache.put(req, newResp.clone());
          return newResp;
        }
        return resp || Response.error();
      }

      // SWR for first-party APIs (short TTL)
      async function handleAPI(req, url) {
        const cache = await caches.open(API_CACHE);
        const cached = await cache.match(req);
        const revalidate = fetch(req, { credentials: 'same-origin' })
          .then(resp => {
            if (resp && resp.status === 200) cache.put(req, resp.clone());
            return resp;
          })
          .catch(() => cached || Response.error());
        return cached || revalidate;
      }

      self.addEventListener('fetch', event => {
        const url = new URL(event.request.url);
        const req = event.request;

        // Bypass third-party iframes/APIs that shouldn't be cached
        if (isThirdParty(url) && isBypassThirdParty(url)) return;

        // Only handle GET
        if (req.method !== 'GET') return;

        if (isHTML(req)) {
          event.respondWith(handleHTML(req));
          return;
        }

        if (url.pathname.startsWith('/api/savings-message')) {
          event.respondWith(handleAPI(req, url));
          return;
        }

        if (isAsset(url)) {
          event.respondWith(handleAsset(req, url));
          return;
        }

        // Default: network-first with cache fallback
        event.respondWith((async () => {
          try {
            const net = await fetch(req);
            return net;
          } catch {
            const cache = await caches.open(ASSET_CACHE);
            const hit = await cache.match(req);
            return hit || Response.error();
          }
        })());
      });
    `;

    try {
      const blobURL = URL.createObjectURL(new Blob([swCode], { type: 'text/javascript' }));
      navigator.serviceWorker.register(blobURL, { scope: '/' }).catch(()=>{});
    } catch (_) {}
  })();
  </script>

  <!-- Worker 016 Chat (sleek, accessible, mobile-first) -->
  <style>
    :root{ --chat-radius:16px; --chat-shadow:0 10px 30px rgba(0,0,0,.18); --chat-border:1px solid rgba(0,0,0,.06); }
    .gfsr-chat-fab{ position:fixed; right:14px; bottom:14px; z-index:9999; display:inline-flex; align-items:center; gap:.5rem; padding:.8rem 1rem; border-radius:999px; border:var(--chat-border); background:#0b63f6; color:#fff; box-shadow:var(--chat-shadow); font:600 14px/1.1 system-ui,-apple-system,Segoe UI,Roboto,Arial; }
    .gfsr-chat-fab:focus-visible{ outline:3px solid #b9d3ff; outline-offset:3px; }
    .gfsr-chat-sheet{ position:fixed; inset:auto 0 0 0; margin:auto; width:100%; max-width:420px; right:12px; left:auto; border-radius:18px 18px 0 0; background:#fff; box-shadow:var(--chat-shadow); transform:translateY(110%); transition:transform .28s ease; border:var(--chat-border); z-index:10000; }
    @media (min-width:720px){ .gfsr-chat-sheet{ bottom:auto; top:calc(12px + env(safe-area-inset-top)); right:12px; left:auto; border-radius:18px; max-height:78vh; width:380px; } }
    .gfsr-chat-sheet.open{ transform:translateY(0); }
    @media (min-width:720px){ .gfsr-chat-sheet.open{ transform:none; position:fixed; bottom:12px; } }
    .gfsr-chat-head{ display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:var(--chat-border); background:#f9fafb; border-radius:inherit; }
    .gfsr-chat-title{ font-weight:700; font-size:15px; }
    .gfsr-chat-close{ background:transparent; border:none; padding:8px; border-radius:10px; cursor:pointer; }
    .gfsr-chat-close:focus-visible{ outline:3px solid #0b63f6; }
    .gfsr-chat-body{ display:flex; flex-direction:column; gap:8px; padding:12px; height:min(70vh, 520px); overflow:auto; -webkit-overflow-scrolling:touch; }
    @media (min-width:720px){ .gfsr-chat-body{ height:56vh; } }
    .gfsr-msg{ max-width:88%; padding:10px 12px; border-radius:14px; font-size:14px; line-height:1.35; }
    .gfsr-msg.user{ margin-left:auto; background:#0b63f6; color:#fff; border-top-right-radius:4px; }
    .gfsr-msg.bot{ background:#eef2ff; color:#111; border-top-left-radius:4px; }
    .gfsr-msg.meta{ background:#f3f4f6; color:#444; font-size:12px; margin:4px auto; }
    .gfsr-chat-input{ display:flex; gap:8px; padding:10px; border-top:var(--chat-border); background:#fff; border-radius:0 0 18px 18px; }
    .gfsr-chat-input textarea{ flex:1; resize:none; min-height:42px; max-height:120px; padding:10px 12px; border:1px solid #e5e7eb; border-radius:12px; font-size:14px; line-height:1.35; }
    .gfsr-chat-send{ background:#0b63f6; color:#fff; border:none; padding:12px 14px; border-radius:12px; font-weight:700; }
    .gfsr-chat-send[disabled]{ opacity:.6; cursor:not-allowed; }
    @media (prefers-reduced-motion:reduce){ .gfsr-chat-sheet{ transition:none; } }
    @media (prefers-color-scheme:dark){
      .gfsr-chat-sheet{ background:#0b0b0d; border-color:#1e1e22; }
      .gfsr-chat-head{ background:#111216; color:#eaeaea; }
      .gfsr-chat-body{ background:#0b0b0d; }
      .gfsr-msg.bot{ background:#1a2236; color:#eaeaea; }
      .gfsr-msg.meta{ background:#121318; color:#c9c9c9; }
      .gfsr-chat-input{ background:#0b0b0d; border-color:#1e1e22; }
      .gfsr-chat-input textarea{ background:#0f0f12; color:#eaeaea; border-color:#1f2532; }
      .gfsr-chat-send{ background:#2d6bf6; }
      .gfsr-chat-fab{ background:#2d6bf6; }
    }
    /* keep clear of the mobile call bar */
    @media (max-width:768px){
      .gfsr-chat-sheet{ margin-bottom:64px; }
      .gfsr-chat-fab{ bottom:78px; }
    }
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;}
  </style>

  <button id="gfsrChatFab" class="gfsr-chat-fab" aria-haspopup="dialog" aria-expanded="false" aria-controls="gfsrChatSheet">💬 Chat</button>

  <section id="gfsrChatSheet" class="gfsr-chat-sheet" role="dialog" aria-modal="true" aria-labelledby="gfsrChatTitle" aria-describedby="gfsrChatDesc">
    <header class="gfsr-chat-head">
      <div>
        <div id="gfsrChatTitle" class="gfsr-chat-title">Debt Help Assistant</div>
        <div id="gfsrChatDesc" class="sr-only">Chat with our assistant. Press Escape to close.</div>
      </div>
      <button id="gfsrChatClose" class="gfsr-chat-close" aria-label="Close chat">✕</button>
    </header>

    <div id="gfsrChatBody" class="gfsr-chat-body" tabindex="0"></div>

    <form id="gfsrChatForm" class="gfsr-chat-input">
      <label class="sr-only" for="gfsrChatInput">Type your message</label>
      <textarea id="gfsrChatInput" rows="1" placeholder="Type a message…" aria-label="Message"></textarea>
      <button id="gfsrChatSend" class="gfsr-chat-send" type="submit">Send</button>
    </form>
  </section>

  <script>
  (() => {
    const el = {
      fab:   document.getElementById('gfsrChatFab'),
      sheet: document.getElementById('gfsrChatSheet'),
      close: document.getElementById('gfsrChatClose'),
      body:  document.getElementById('gfsrChatBody'),
      form:  document.getElementById('gfsrChatForm'),
      input: document.getElementById('gfsrChatInput'),
      send:  document.getElementById('gfsrChatSend'),
    };

    const openChat = () => { el.sheet.classList.add('open'); el.fab.setAttribute('aria-expanded','true'); setTimeout(()=>el.input.focus(),120); };
    const closeChat = () => { el.sheet.classList.remove('open'); el.fab.setAttribute('aria-expanded','false'); el.fab.focus(); };
    el.fab.addEventListener('click', openChat);
    el.close.addEventListener('click', closeChat);
    window.addEventListener('keydown', e => { if (e.key==='Escape' && el.sheet.classList.contains('open')) closeChat(); });

    const addMsg = (text, who='bot') => {
      const div = document.createElement('div'); div.className = `gfsr-msg ${who}`; div.textContent = (text??'').toString();
      el.body.appendChild(div); el.body.scrollTop = el.body.scrollHeight;
    };

    const KEY = 'gfsr-chat-history';
    const remember = (text, who) => { try {
      const hist = JSON.parse(localStorage.getItem(KEY) || '[]'); hist.push({text, who, t: Date.now()});
      localStorage.setItem(KEY, JSON.stringify(hist).slice(-8000));
    } catch {} };
    try { (JSON.parse(localStorage.getItem(KEY) || '[]')).slice(-20).forEach(m=>addMsg(m.text,m.who)); } catch {}

    const API = `${location.origin}/chat`;
    let busy = false;

    el.form.addEventListener('submit', async (e) => {
      e.preventDefault();
      if (busy) return;
      const message = (el.input.value||'').trim();
      if (!message) return;

      addMsg(message,'user'); remember(message,'user');
      el.input.value=''; busy=true; el.send.disabled=true;

      try{
        const r = await fetch(API, {
          method:'POST',
          headers:{ 'Content-Type':'application/json', 'Accept':'application/json' },
          body: JSON.stringify({
            messages: [{ role:'user', content: message }],
            source: 'frontend',
            url: location.href
          })
        });

        if(!r.ok) throw new Error('HTTP '+r.status);

        const ct = r.headers.get('content-type')||''; let reply='';
        if (ct.includes('application/json')) {
          const data = await r.json();
          reply = data.reply || data.message || JSON.stringify(data);
        } else {
          reply = await r.text();
        }
        addMsg(reply || 'Thanks — how else can I help?','bot'); remember(reply||'','bot');
      }catch(err){
        console.error(err); addMsg('Sorry — the chat service is busy. Please try again shortly.','meta');
      }finally{
        busy=false; el.send.disabled=false; el.input.focus();
      }
    });

    // Enter submits; Shift+Enter = newline
    el.input.addEventListener('keydown', e => { if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); el.form.requestSubmit(); } });

    if (!el.body.children.length) addMsg('Hi! I can help you compare debt relief options and next steps.');
  })();
  </script>

  <noscript><p style="text-align:center;color:#666">For the best experience, please enable JavaScript to load your personalized savings estimate.</p></noscript>
</body>
</html>
